import i18n from "i18next";
import { initReactI18next } from "react-i18next";

const resources = {
    "zh-CN": {
        translation: {
            "app_title": "暗黑2重制版 多开助手",
            "version": "Rust 重写版 v0.1.0-alpha",
            "isolation_mode": "安全隔离引擎",
            "kill_mutex": "清理多开限制 (Mutex)",
            "add_account": "添加账号",
            "no_accounts": "暂无账号配置，请添加 Windows 账户以开始。",
            "launch": "启动",
            "ready": "就绪",
            "settings": "设置",
            "settings_placeholder": "更多功能开发中...",
            "game_path": "游戏路径 (D2R.exe)",
            "dashboard": "仪表盘",
            "accounts": "账号管理",
            "manual": "工具",
            "browse": "浏览",
            "save": "保存",
            "cancel": "取消",
            "account_manager": "账号管理",
            "manage_accounts_hint": "配置并同步你的 Windows 账户实体",
            "no_accounts_hint": "暂无账号配置，请在账号管理中添加 Windows 账户以开始。",
            "confirm_delete_title": "确认删除",
            "confirm_delete_desc": "确定要删除该账号配置吗？此操作不可撤销。",
            "confirm_delete": "确定要删除该账号配置吗？",
            "no_bnet_id": "未绑定 Bnet ID",
            "username": "用户名 (Windows)",
            "password": "密码 (选填)",
            "password_hint": "如果在 Windows 设置了免密登录，此处留空即可。",
            "logs_title": "系统日志",
            "success": "成功",
            "error": "错误",
            "info": "信息",
            "launching": "正在启动...",
            "account_sanctum": "账号营地",
            "setting_close_to_tray": "最小化到系统托盘",
            "setting_close_to_tray_desc": "点击关闭按钮时，保持应用在后台运行",
            "appearance": "外观定制",
            "entities_registered": "{{count}} 个实体已注册",
            "isolation_core_ready": "隔离核心已就绪",
            "launch_game": "启动游戏",
            "kill_success": "成功清理 Mutex 句柄。",
            "config_saved": "配置已保存。",
            "path_missing": "未设置游戏路径！请前往设置。",
            "rotation_warn": "轮转保存警告",
            "pin_warning": "Windows API 需要登录密码，不支持 PIN 码或 Windows Hello。",
            "host_no_pass_hint": "当前登录用户 [Host] 不需要输入密码。",
            "host_current": "当前登录",
            "manual_entry": "域/工作账户",
            "domain_work_account_link": "找不到用户？使用域/工作账户登录",
            "back_to_list": "返回列表",
            "debug_mode_warning": "调试控制台 / 原子操作执行",
            "debug_mode_desc": "本面板暴露启动序列的每一个底层步骤。用于排查文件锁占用或权限问题。",
            "use_existing_user": "使用已有用户",
            "create_new_win_user": "创建新 Windows 用户",
            "edit_account": "编辑账号",
            "win_user_binding": "Windows 用户绑定",
            "win_username": "Windows 用户名",
            "win_password": "Windows 密码",
            "win_create_warning": "* 将创建标准本地用户。需要管理员权限执行。",
            "note_placeholder": "例如：主力法师, 仓库号...",
            "bnet_account": "Bnet 备注/账号 (选填)",
            "scan_users": "扫描更多用户 (Deep Scan)",
            "select_win_user": "选择 Windows 用户 (仅列出本地)",
            "scan_hint": "默认仅显示本地用户。点击扫描以通过注册表反查域/微软账号。可能会稍慢并出现重名。",
            "debug_cleanup_title": "环境清理",
            "kill_processes_clashpad": "终止 Battle.net / Agent / Clashpad",
            "kill_mutex_force": "强制关除游戏句柄 (Mutex)",
            "delete_global_db_nuke": "删除全局 Product.db (清理状态)",
            "direct_boot_title": "独立启动尝试",
            "launch_as_identity": "以身份启动: {{user}}",
            "atomic_logs": "原子操作日志",
            "clear_logs": "清空",
            "waiting_ops": "等待执行指令...",
            // Mirror Tool
            "mirror_title": "目录镜像 (Junction)",
            "mirror_desc": "为单客户端创建镜像目录，用于多开环境下的配置隔离。",
            "mirror_source": "源游戏目录",
            "mirror_dest": "镜像目标路径",
            "mirror_name": "镜像名称",
            "mirror_btn_create": "创建镜像",
            "mirror_success": "镜像创建成功: {{name}}",
            "mirror_error_exists": "目标路径已存在: {{path}}",
            "mirror_error_invalid": "输入信息不完整或路径无效",
            "mirror_selecting": "选择目录...",
            // AI Analysis
            "ai_analyze_btn": "截图问 AI (Ctrl+Shift+S)",
            "ai_analyzing": "正在截屏并分析...",
            "ai_result_title": "AI 装备分析",
            "ai_setting_title": "AI 提供商设置",
            "ai_setting_model": "AI 模型",
            "ai_setting_key": "API 密钥",
            "ai_setting_prompt": "自定义提示词",
            "ai_setting_hotkey": "截图热键",
            "ai_screenshot_active": "功能开启",
            "recording": "正在录制...",
            "ai_ask": "问 AI",
        }
    },
    "en": {
        translation: {
            "app_title": "D2R Multiplay",
            "version": "Rust Rewrite v0.1.0-alpha",
            "isolation_mode": "Isolation Engine",
            "kill_mutex": "Kill Mutexes",
            "add_account": "Add Account",
            "no_accounts": "No accounts configured. Add a Windows account to start.",
            "launch": "Launch",
            "ready": "Ready",
            "settings": "Settings",
            "settings_placeholder": "More features coming soon...",
            "game_path": "Game Path (D2R.exe)",
            "dashboard": "Dashboard",
            "accounts": "Accounts",
            "manual": "Tools",
            "browse": "Browse",
            "save": "Save",
            "cancel": "Cancel",
            "username": "Username",
            "password": "Password (Optional)",
            "password_hint": "Leave empty if account has no password.",
            "logs_title": "System Logs",
            "success": "Success",
            "error": "Error",
            "info": "Info",
            "launching": "Launching...",
            "account_sanctum": "Account Camp",
            "setting_close_to_tray": "Minimize to Tray",
            "setting_close_to_tray_desc": "Keep the app running in the background when closed",
            "appearance": "Appearance",
            "entities_registered": "{{count}} Entities Registered",
            "isolation_core_ready": "Isolation Core Primed & Ready",
            "launch_game": "Launch Game",
            "kill_success": "Mutexes killed successfully.",
            "config_saved": "Configuration saved.",
            "path_missing": "Game path not set! Please check settings.",
            "rotation_warn": "Rotation Warning",
            "pin_warning": "Windows API requires the real Password. PIN codes or Windows Hello are not supported.",
            "host_no_pass_hint": "Current User [Host] doesn't need a password.",
            "host_current": "Host",
            "manual_entry": "Domain Account",
            "domain_work_account_link": "Can't find user? Use Domain/Work Account",
            "back_to_list": "Back to List",
            "debug_mode_warning": "Debug Console / Atomic Ops",
            "debug_mode_desc": "Exposes inner atomic steps of the launch sequence. Use for troubleshooting.",
            "use_existing_user": "Use Existing User",
            "create_new_win_user": "Create New User",
            "edit_account": "Edit Account",
            "win_user_binding": "Windows User Binding",
            "win_username": "Windows Username",
            "win_password": "Windows Password",
            "win_create_warning": "* Standard local user will be created. Needs Admin rights.",
            "note_placeholder": "e.g. Main Sorc, Crafting Mule...",
            "bnet_account": "Bnet Remark / ID",
            "scan_users": "Deep Scan (MS/Domain)",
            "select_win_user": "Select Windows User (Local)",
            "scan_hint": "Default: Local users only. Deep scan resolves Domain/MS accounts via SID. May be slow.",
            "confirm_delete_title": "Confirm Delete",
            "confirm_delete_desc": "Are you sure you want to delete this account configuration? This action cannot be undone.",
            "no_accounts_hint": "No accounts configured. Please add a Windows account in Account Manager to start.",
            "debug_cleanup_title": "Environment Cleanup",
            "kill_processes_clashpad": "Kill Battle.net / Agent / Clashpad",
            "kill_mutex_force": "Force Kill Game Mutexes",
            "delete_global_db_nuke": "Nuke Global Product.db (Clear State)",
            "direct_boot_title": "Independent Launch Attempt",
            "launch_as_identity": "Launch as Identity: {{user}}",
            "atomic_logs": "Atomic Logs",
            "clear_logs": "Clear",
            "waiting_ops": "Waiting for operations...",
            // Mirror Tool
            "mirror_title": "Directory Mirror (Junction)",
            "mirror_desc": "Create a mirrored directory for a single client to isolate configurations in multi-play environments.",
            "mirror_source": "Source Game Directory",
            "mirror_dest": "Mirror Target Path",
            "mirror_name": "Mirror Name",
            "mirror_btn_create": "Create Mirror",
            "mirror_success": "Mirror created successfully: {{name}}",
            "mirror_error_exists": "Target path already exists: {{path}}",
            "mirror_error_invalid": "Incomplete input or invalid path",
            "mirror_selecting": "Selecting directory...",
            // AI Analysis
            "ai_analyze_btn": "Ask AI about Item (Ctrl+Shift+S)",
            "ai_analyzing": "Capturing & Analyzing...",
            "ai_result_title": "AI Equipment Analysis",
            "ai_setting_title": "AI Provider Settings",
            "ai_setting_model": "AI Model",
            "ai_setting_key": "API Key",
            "ai_setting_prompt": "Custom Prompt",
            "ai_setting_hotkey": "Screenshot Hotkey",
            "ai_screenshot_active": "AI Active",
            "recording": "Recording...",
            "ai_ask": "Ask AI",
        }
    },
    "zh-TW": {
        translation: {
            "app_title": "暗黑2重製版 多開助手",
            "version": "Rust 重寫版 v0.1.0-alpha",
            "isolation_mode": "安全隔離引擎",
            "kill_mutex": "清理多開限制 (Mutex)",
            "add_account": "新增帳號",
            "no_accounts": "暫無帳號配置，請新增 Windows 帳戶以開始。",
            "launch": "啟動",
            "ready": "就緒",
            "settings": "設定",
            "game_path": "遊戲路徑 (D2R.exe)",
            "dashboard": "儀表板",
            "accounts": "帳號管理",
            "manual": "調試工具",
            "browse": "瀏覽",
            "save": "儲存",
            "cancel": "取消",
            "username": "使用者名稱",
            "password": "密碼 (選填)",
            "password_hint": "若 Windows 已設定免密登入，此處留空即可。",
            "logs_title": "系統日誌",
            "success": "成功",
            "error": "錯誤",
            "info": "資訊",
            "launching": "正在啟動...",
            "account_sanctum": "帳號營地",
            "setting_close_to_tray": "最小化到系統托盤",
            "setting_close_to_tray_desc": "點擊關閉按鈕時，保持應用在後台運行",
            "appearance": "外觀定制",
            "entities_registered": "{{count}} 個實體已註冊",
            "isolation_core_ready": "隔離核心已就緒",
            "launch_game": "啟動遊戲",
            "kill_success": "成功清理 Mutex。",
            "config_saved": "配置已儲存。",
            "path_missing": "未設定遊戲路徑！請前往設定。",
            "rotation_warn": "輪轉儲存警告",
            "scan_users": "掃描更多用戶 (Deep Scan)",
            "select_win_user": "選擇 Windows 用戶 (僅列出本地)",
            "scan_hint": "默認僅顯示本地用戶。點擊掃描以獲取域/微軟帳號。可能會稍慢並出現重名。",
        }
    },
    "ja": {
        translation: {
            "app_title": "D2R マルチプレイ",
            "version": "Rust Rewrite v0.1.0-alpha",
            "isolation_mode": "分離エンジン",
            "kill_mutex": "多重起動制限解除 (Mutex)",
            "add_account": "アカウント追加",
            "no_accounts": "アカウントがありません。Windowsアカウントを追加してください。",
            "launch": "起動",
            "ready": "準備完了",
            "settings": "設定",
            "game_path": "ゲームパス (D2R.exe)",
            "dashboard": "ダッシュボード",
            "accounts": "アカウント管理",
            "manual": "手動ツール",
            "browse": "参照",
            "save": "保存",
            "cancel": "キャンセル",
            "username": "ユーザー名",
            "password": "パスワード (任意)",
            "password_hint": "パスワードがない場合は空欄にしてください。",
            "logs_title": "システムログ",
            "success": "成功",
            "error": "エラー",
            "info": "情報",
            "launching": "起動中...",
            "account_sanctum": "アカウントサンクタム",
            "entities_registered": "{{count}} つのエンティティが登録済み",
            "isolation_core_ready": "分離コア準備完了",
            "launch_game": "ゲーム起動",
            "kill_success": "Mutexの解除に成功しました。",
            "config_saved": "設定を保存しました。",
            "path_missing": "ゲームパスが設定されていません。",
            "rotation_warn": "ローテーション警告",
            "scan_users": "詳細スキャン (MS/ドメイン)",
            "select_win_user": "Windowsユーザーを選択 (ローカルのみ)",
            "scan_hint": "デフォルトではローカルユーザーのみ表示されます。詳細スキャンでドメイン/MSアカウントを取得します。",
        }
    },
    "ko": {
        translation: {
            "app_title": "D2R 멀티플레이",
            "version": "Rust Rewrite v0.1.0-alpha",
            "isolation_mode": "격리 엔진",
            "kill_mutex": "다중 실행 제한 해제 (Mutex)",
            "add_account": "계정 추가",
            "no_accounts": "계정이 구성되지 않았습니다. 시작하려면 Windows 계정을 추가하세요.",
            "launch": "실행",
            "ready": "준비됨",
            "settings": "설정",
            "game_path": "게임 경로 (D2R.exe)",
            "dashboard": "대시보드",
            "accounts": "계정 관리",
            "manual": "수동 도구",
            "browse": "찾아보기",
            "save": "저장",
            "cancel": "취소",
            "username": "사용자 이름",
            "password": "비밀번호 (선택)",
            "password_hint": "비밀번호가 없으면 비워두세요.",
            "logs_title": "시스템 로그",
            "success": "성공",
            "error": "오류",
            "info": "정보",
            "launching": "실행 중...",
            "account_sanctum": "계정 성소",
            "entities_registered": "{{count}} 개 엔티티 등록됨",
            "isolation_core_ready": "격리 코어 준비 완료",
            "launch_game": "게임 실행",
            "kill_success": "Mutex 해제 성공.",
            "config_saved": "구성이 저장되었습니다.",
            "path_missing": "게임 경로가 설정되지 않았습니다!",
            "rotation_warn": "로테이션 경고",
            "scan_users": "상세 스캔 (MS/도메인)",
            "select_win_user": "Windows 사용자 선택 (로컬 전용)",
            "scan_hint": "기본적으로 로컬 사용자만 표시됩니다. 상세 스캔으로 도메인/MS 계정을 가져옵니다.",
        }
    }
};

i18n
    .use(initReactI18next)
    .init({
        resources,
        lng: "zh-CN", // Default language
        fallbackLng: "en",
        interpolation: {
            escapeValue: false
        }
    });

// Listen for language changes and update System Tray
i18n.on('languageChanged', (lng) => {
    import("@tauri-apps/api/core").then(({ invoke }) => {
        invoke('update_tray_language', { lang: lng }).catch(console.error);
    });
});

// Initial update on load
// We need to wait a tick or ensure invoke is ready, but typically it is.
setTimeout(() => {
    import("@tauri-apps/api/core").then(({ invoke }) => {
        invoke('update_tray_language', { lang: i18n.language }).catch(console.error);
    });
}, 500);

export default i18n;
